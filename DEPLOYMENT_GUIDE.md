# دليل النشر والربط: من جهازك المحلي إلى السحابة مع Cloudflare و Supabase

هذا الدليل يشرح بالتفصيل كيفية نشر تطبيق إدارة المخزون على منصة Cloudflare Pages وربطه بقاعدة بيانات حقيقية على Supabase.

---

## الجزء الأول: إعداد قاعدة البيانات على Supabase

الخطوة الأولى هي إنشاء قاعدة بيانات سحابية لتخزين بيانات التطبيق بشكل دائم وآمن.

### 1. إنشاء مشروع جديد في Supabase
- اذهب إلى [supabase.com](https://supabase.com) وقم بإنشاء حساب مجاني.
- من لوحة التحكم، اضغط على **"New project"**.
- اختر اسمًا لمشروعك، أنشئ كلمة مرور قوية لقاعدة البيانات، واختر المنطقة الأقرب لك.
- انتظر بضع دقائق حتى يتم إعداد مشروعك بالكامل.

### 2. الحصول على مفاتيح الاتصال (API Keys)
- بعد إنشاء المشروع، اذهب إلى **Project Settings** (أيقونة الترس في القائمة اليسرى).
- اختر قسم **API**.
- ستحتاج إلى معلومتين من هذه الصفحة:
    1.  **Project URL**: عنوان URL الخاص بمشروعك.
    2.  **Project API Keys -> `anon` `public`**: هذا هو المفتاح العام والآمن للاستخدام في الواجهة الأمامية.
- **احتفظ بهاتين المعلومتين، ستحتاجهما قريبًا.**

### 3. إنشاء جداول قاعدة البيانات
- الآن تحتاج إلى إنشاء الهيكل (Schema) الذي سيحفظ بياناتك. لقد قمنا بتسهيل هذه الخطوة.
- **شغّل التطبيق على جهازك المحلي** (باستخدام `npm run dev`).
- اذهب إلى صفحة **الإعدادات (Admin Settings)** ثم اختر تبويب **"Supabase"**.
- اضغط على زر **"Generate Table Script"**. سيقوم هذا بنسخ كود SQL جاهز إلى حافظتك (Clipboard).
- ارجع إلى لوحة تحكم Supabase، ومن القائمة اليسرى، اختر **SQL Editor**.
- اضغط على **"+ New query"**.
- **الصق (Paste)** الكود الذي نسخته من التطبيق في محرر الـ SQL.
- اضغط على زر **"RUN"** الأخضر.
- تهانينا! لقد قمت بإنشاء كل الجداول التي يحتاجها التطبيق (`supplies`, `manufacturers`, `suppliers`, إلخ) بالهيكلية الصحيحة.

---

## الجزء الثاني: نشر التطبيق على Cloudflare Pages

الآن سنقوم برفع واجهة التطبيق على الإنترنت لتكون متاحة للجميع.

### 1. رفع المشروع على GitHub
- يجب أن يكون كود المشروع موجودًا في مستودع (repository) على [GitHub](https://github.com).
- إذا لم يكن كذلك، قم بإنشاء مستودع جديد وارفع ملفات المشروع إليه.

### 2. إنشاء مشروع جديد في Cloudflare Pages
- سجل الدخول إلى حسابك في [Cloudflare](https://dash.cloudflare.com/).
- من القائمة اليسرى، اذهب إلى **Workers & Pages**.
- اضغط على **"Create application"** ثم اختر تبويب **"Pages"**.
- اضغط على **"Connect to Git"**.
- قم بربط حسابك في Cloudflare بحسابك في GitHub واختر المستودع الذي يحتوي على كود التطبيق.

### 3. إعداد عملية البناء والنشر (Build & Deploy)
- بعد اختيار المستودع، ستظهر لك صفحة إعدادات البناء.
- تأكد من أن الإعدادات كالتالي:
    - **Production branch**: اختر `main` (أو الفرع الرئيسي لمشروعك).
    - **Framework preset**: اختر `Vite`.
    - **Build command**: `npm run build`
    - **Build output directory**: `dist`
- اضغط على **"Save and Deploy"**.

ستقوم Cloudflare الآن بسحب الكود من GitHub، تثبيت الاعتماديات، بناء المشروع، ونشره على شبكتها العالمية. قد تستغرق هذه العملية بضع دقائق. بعد الانتهاء، ستعطيك Cloudflare رابطًا لموقعك المباشر (مثال: `your-app.pages.dev`).

---

## الجزء الثالث: الربط النهائي

الخطوة الأخيرة هي إخبار تطبيقك المنشور على Cloudflare بكيفية الاتصال بقاعدة بياناتك على Supabase.

### 1. إدخال بيانات الاتصال
- افتح الرابط الخاص بتطبيقك الذي حصلت عليه من Cloudflare.
- اذهب إلى صفحة **الإعدادات (Admin Settings)** ثم تبويب **"Supabase"**.
- في حقل **"Supabase URL"**، الصق الـ **Project URL** الذي حصلت عليه من Supabase.
- في حقل **"Supabase Anon Key"**، الصق الـ **`anon` `public` key**.
- اضغط على زر **"Test Connection"**.

### 2. التأكد من نجاح الاتصال
- إذا كانت البيانات صحيحة، سيظهر لك مؤشر أخضر بجانب الزر مع رسالة "Connected".
- سيقوم التطبيق تلقائيًا بحفظ هذه البيانات في `localStorage` الخاص بالمتصفح، لذلك لن تحتاج إلى إدخالها في كل مرة تزور فيها الموقع من نفس المتصفح.

**لقد انتهيت!** تطبيقك الآن يعمل بشكل كامل على السحابة، مع واجهة أمامية سريعة على Cloudflare Pages وقاعدة بيانات قوية ومستدامة على Supabase.
