# خطة عمل المشروع (Project Plan)

هذه الخطة تحدد المهام الرئيسية المطلوبة لنقل المشروع من نموذج أولي إلى تطبيق متكامل.

## المرحلة صفر: بناء الواجهات المتقدمة (مكتمل)
- **الهدف:** بناء جميع الواجهات الأمامية للميزات المتقدمة باستخدام بيانات مؤقتة.
- **المهام:**
    - [x] إعادة هيكلة البيانات لفصل تعريف المنتج عن المخزون.
    - [x] تطوير واجهة تعريف المنتجات مع ميزة "حد الطلب".
    - [x] تطوير واجهة إضافة المخزون.
    - [x] إضافة ميزة المخازن المتعددة وصفحة إدارتها.
    - [x] إضافة ميزة نقل المخزون.
    - [x] دمج ماسح الباركود في العمليات الرئيسية.
    - [x] بناء واجهة تقرير جرد المخزون.
    - [x] بناء واجهة تقرير حد الطلب.
    - [x] تفعيل ميزة استيراد وتصدير تعريف المنتجات.

## المرحلة الأولى: التحول إلى Supabase (مكتمل)
- **الهدف:** استبدال البيانات المؤقتة بقاعدة بيانات Supabase بشكل كامل.
- **المهام:**
    1.  **[x] إنشاء عميل Supabase:** إنشاء ملف `src/lib/supabaseClient.ts`.
    2.  **[x] تعديل عمليات البيانات (`src/data/operations`):**
        - [x] تعديل جميع الدوال لجلب وتحديث البيانات من Supabase بدلاً من `mockData`.
    3.  **[x] ربط الواجهة بـ `react-query`:**
        - [x] تغليف دوال Supabase الجديدة بـ `useQuery` و `useMutation` في جميع الصفحات.
    4.  **[x] إزالة الكود القديم:**
        - [x] حذف جميع ملفات `mockData` والبيانات المؤقتة.

## مرحلة الإصلاحات والتكامل (مكتمل)
- **الهدف:** إصلاح الأخطاء الناشئة وضمان تكامل جميع الميزات مع قاعدة البيانات.
- **المهام:**
    - [x] **إصلاح القائمة الجانبية:** حل مشكلة الترجمة والروابط المعطلة.
    - [x] **تكامل وحدة الاستهلاك:** إعادة كتابة `consumptionOperations.ts` ليعمل مع Supabase.
    - [x] **تحديث سكربت قاعدة البيانات:** إضافة دوال RPC (`create_consumption_record`, `delete_consumption_record`) للتعامل مع عمليات الاستهلاك بشكل آمن.
    - [x] **تفعيل وظائف الواجهة:** إعادة تفعيل الروابط ودوال الحذف بعد إصلاح منطق الخلفية.
    - [x] **إعادة هيكلة صفحة الإعدادات:** إصلاح جميع التبويبات الفرعية وتحسين استجابتها للشاشات الصغيرة.
    - [x] **مراجعة شاملة للاستجابة:** فحص وإصلاح جميع صفحات التطبيق لضمان توافقها مع الموبايل.
    - [x] **تحسين ماسح الباركود:** تفعيل التركيز التلقائي وتحسين دقة القراءة.

## المرحلة الثانية: نظام المصادقة والأمان (مكتمل)
- **الهدف:** إضافة نظام تسجيل دخول وحماية المسارات.
- **المهام:**
    1.  **[x] إعداد Supabase Auth:** تم إنشاء `authOperations.ts` للتعامل مع دوال المصادقة.
    2.  **[x] إنشاء `AuthContext`:** تم إنشاء سياق لتوفير حالة المصادقة للتطبيق.
    3.  **[x] إنشاء صفحة تسجيل دخول:** تم بناء واجهة تسجيل الدخول في `LoginPage.tsx`.
    4.  **[x] حماية المسارات:** تم إنشاء `ProtectedRoute` وتطبيقه على جميع مسارات التطبيق.

## المرحلة الثالثة: تحسينات وتطويرات
- **الهدف:** إضافة ميزات جديدة وتحسين التجربة.
- **المهام:**
    1.  **[x] إعادة بناء ماسح الباركود:** التحول إلى واجهة برمجة التطبيقات الأصلية للمتصفح لضمان أقصى سرعة ودقة.
    2.  **[ ] بناء واجهة تقارير موحدة:** إعادة تصميم صفحة التقارير لتجميع كل التقارير (جرد، حد الطلب، استهلاك) في واجهة واحدة مع تبويبات.
    2.  **[ ] تطوير واجهة إضافة مخزون مجمّع:** إنشاء واجهة جديدة تسمح بإضافة عدة أصناف مخزون دفعة واحدة.
    3.  **[ ] ربط التقارير بالبيانات الحية:** التأكد من أن جميع التقارير تعمل بشكل ديناميكي مع Supabase.
    4.  **[ ] كتابة الاختبارات (Testing).**

## المرحلة الرابعة: التحويل إلى تطبيق موبايل (مقترح)
- **الهدف:** تحقيق أقصى أداء لمسح الباركود عن طريق الوصول المباشر لكاميرا الموبايل.
- **المهام:**
    1.  **[ ] دمج Capacitor:** إعداد المشروع لاستخدام Capacitor لتغليف تطبيق الويب.
    2.  **[ ] بناء نسخة أندرويد:** توليد مشروع أندرويد من الكود الحالي.
    3.  **[ ] استخدام إضافة الكاميرا الأصلية:** استبدال ماسح الويب الحالي بإضافة Capacitor للوصول المباشر للكاميرا.

---
**ملاحظة:** سيتم تحديث هذه الخطة بوضع علامة `[x]` بجانب كل مهمة مكتملة.
